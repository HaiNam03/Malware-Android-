import streamlit as st
import pickle
import re

st.title('APK Malware Classifier')
choice = st.selectbox("Please select your machine learning model",
                      [
                        'Support Vector Machine', 'Decision Tree', 'Random Forest', 'AdaBoostClassifier', 'GaussianNB',
                        'MLPClassifier'
                      ]
                      )
model = pickle.load(open('svm.pkl', 'rb'))

if choice == 'Support Vector Machine':
    model = pickle.load(open('svm.pkl', 'rb'))
    st.write('SVM model is selected!')
elif choice == 'Decision Tree':
    model = pickle.load(open('dt.pkl', 'rb'))
    st.write('DT model is selected!')
elif choice == 'Random Forest':
    model = pickle.load(open('rf.pkl', 'rb'))
    st.write('RF model is selected!')
elif choice == 'AdaBoostClassifier':
    model = pickle.load(open('ab.pkl', 'rb'))
    st.write('AB model is selected!')
elif choice == 'GaussianNB':
    model = pickle.load(open('gnb.pkl', 'rb'))
    st.write('GNB model is selected!')
elif choice == 'MLPClassifier':
    model = pickle.load(open('mlp.pkl', 'rb'))
    st.write('MPL model is selected!')


def preprocess_text(text):
    text = re.sub(r'http\S+', '', text)
    text = re.sub(r'[^\w\s]', '', text)
    text = text.lower()
    text = re.sub(r'\s+', ' ', text).strip()
    return text
tfidf = pickle.load(open('vectorizer.pkl', 'rb'))

input_apicall = st.text_input('Enter the API call ')

# option = st.selectbox("You Got Message From :-", ["Via Email ", "Via SMS", "other"])



if st.button('Click to Predict'):
    transform_text = preprocess_text(input_apicall)
    vector_input = tfidf.transform([transform_text])
    result = model.predict(vector_input)[0]


    if result == 1:
        st.header("Malware")
    else:
        st.header('Begin')